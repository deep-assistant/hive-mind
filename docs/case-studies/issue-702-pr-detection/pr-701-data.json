{"author":{"id":"MDQ6VXNlcjE0MzE5MDQ=","is_bot":false,"login":"konard","name":"Konstantin Diachenko"},"body":"## Summary\n\nThis PR fixes the code block escaping issue when logs are posted as GitHub comments (issue #700).\n\n### Problem\n\nWhen solution draft logs containing code blocks (triple backticks ```) were posted to GitHub PRs/issues as comments, the inner code blocks would prematurely close the outer markdown code block, breaking the formatting. This was visible in comments like [this one](https://github.com/deep-assistant/hive-mind/pull/699#issuecomment-3511428178) where the log markdown formatting was broken.\n\n### Solution\n\nAdded a new `escapeCodeBlocksInLog()` function that:\n- Escapes all triple backticks in log content by inserting zero-width spaces (`\\\\u200B`) between them\n- Prevents the inner backticks from being interpreted as markdown code block delimiters\n- Maintains visual appearance while fixing the formatting issue\n\n### Changes\n\n1. **src/github.lib.mjs**:\n   - Added `escapeCodeBlocksInLog()` function to escape code blocks\n   - Integrated escaping into `attachLogToGitHub()` for regular comments\n   - Integrated escaping into `attachTruncatedLog()` for consistency\n   - Note: Gists don't need escaping since they're plain text files\n\n2. **experiments/test-code-block-escaping.mjs**:\n   - Test script to verify escaping works correctly\n   - Tests with realistic log content containing code blocks\n   - Verifies no unescaped triple backticks remain\n\n### Testing\n\nThe test script confirms that:\n- All triple backticks in log content are properly escaped\n- The escaped content can be safely embedded in markdown code blocks\n- The markdown structure remains intact\n\nFixes #700","closingIssuesReferences":[{"id":"I_kwDOPUU0qc7XDGFE","number":700,"repository":{"id":"R_kgDOPUU0qQ","name":"hive-mind","owner":{"id":"O_kgDOC9Vb7A","login":"deep-assistant"}},"url":"https://github.com/deep-assistant/hive-mind/issues/700"}],"createdAt":"2025-11-10T12:51:26Z","isDraft":false,"number":701,"state":"OPEN","title":"Fix code block escaping in log comments","url":"https://github.com/deep-assistant/hive-mind/pull/701"}
